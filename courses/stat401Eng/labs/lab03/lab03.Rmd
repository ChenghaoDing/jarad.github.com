---
title: "Lab03 - Probability Distributions in R"
author: "Jarad Niemi"
date: "`r Sys.Date()`"
output: html_document
---


To follow along, use the [lab03 code](lab03.R).

## Probability distributions in R

Many of the standard probability distributions have functions in R to calculate:

 - probability density/mass function (d)
 - cumulative distribution function (p)
 - quantile function (q)
 - random draws (r)
 
The letter after each indicates the letter the function will start with for 
all distributions.
 

### Discrete distributions

If the support of the random variable is a finite or countably infinite number
of values, then the random variable is discrete.
Discrete random variables have a 
[probability mass function (pmf)](https://en.wikipedia.org/wiki/Probability_mass_function).
This pmf gives the probability that a random variable will take on each value 
in its support. 
The cumulative distribution function (cdf)](https://en.wikipedia.org/wiki/Cumulative_distribution_function)
provides the probability the random variable is less than or equal to a particular
value.
The quantile function is the inverse of the cumulative distribution function, 
i.e. you provide a probability and the quantile function returns the value of the
random variable such the cdf will return that probability.

#### Binomial distribution

Whenever you repeat an experiment and you assume 

1. the probability of success is the same each time and 
1. each trial of the experiment is independent of the rest (as long as you know the probability of success).

Then, if you record the number of success out of the total, you have a 
[binomial distribution](https://en.wikipedia.org/wiki/Binomial_distribution).

For example, consider an experiment with probability of success of 0.7 and 13
trials, i.e. $X\simBin(13,0.7)$. 
Here is the pmf using the `dbinom` function:

```{r}
n <- 13
p <- 0.7
x <- 0:n

plot(x, dbinom(x, n, p))
```
 
Here is the cdf using the `pbinom` function:

```{r}
plot(x, pbinom(x, n, p), type="s")
```

For a discrete random variable, the cdf is a step function since the function 
*jumps* whenever it comes across a value in the support for the random variable.

Here is the quantile function using the `qbinom` function:

```{r}
p_seq <- seq(from = 0, to = 1, length = 101)
plot(p_seq, qbinom(p_seq, n, p), type="s")
```
 
Finally, we can draw random values from this binomial distribution using the 
`rbinom` function. 

```{r}
draws <- rbinom(100, n, p) # draw 100
brks  <- (0:(n+1)) - 0.5
hist(draws, breaks = brks) 
```
 
Rather than having the number of draws, we often want the percentage of draws. 
For reference, we can add the true probabilities using the pmf 
(shown in red).

```{r}
hist(draws, breaks = brks, probability = TRUE)
points(x, dbinom(x, n, p), col="red")
```


#### Activity

Plot the pdf, cdf, and quantile function for the binomial distribution with 
probability of success 0.25 and 39 trials, i.e. $X\sim Bin(39,0.25)$. 
Then sample 999 random binomials with 39 trials and probability of success 0.25
and plot them on a histogram with the true probability mass function.

<div id="binomial_activity_solution" style="display:none"> 
```{r, purl=FALSE}
n <- 39
p <- 0.25
x <- 0:n

plot(x, dbinom(x, n, p),                     main = 'Probability mass function')
plot(x, pbinom(x, n, p),         type = 's', main = 'Cumulative distribution function')
plot(p_seq, qbinom(p_seq, n, p), type = 's', main = 'Quantile function')

draws <- rbinom(100, n, p) # draw 100
brks  <- (0:(n+1)) - 0.5
hist(draws, breaks = brks, probability = TRUE)
points(x, dbinom(x, n, p), col="red")
```
</div> 
<button title="Show a solution" type="button" onclick="if(document.getElementById('binomial_activity_solution') .style.display=='none') {document.getElementById('binomial_activity_solution') .style.display=''}else{document.getElementById('binomial_activity_solution') .style.display='none'}">Show/Hide Solution</button>



 
 
#### Poisson distribution


 
 
### Uniform distribution
 
The uniform distribution is one of the easiest distributions to understand. 
If Y is a random variable and it is uniformly distributed between a and b, 
then we write $X\simUnif(a,b)$. 
 
#### Probability density function
 
The probability density function for a uniform random variable is zero outside
of a and b (indicating that the random variable cannot take values below a
or above b) and is constant at a value of 1/(b-a) from a to b. 
 
```{r}
a <- 0
b <- 1
curve(dunif(x, min = a, max = b), from = -1, to = 2,
      xlab='y', ylab='f(y)', main='Probability density function for Unif(0,1)')
```
 
#### Cumulative distribution function
 
The cumulative distribution function is the integral from negative infinite 
up to y of the probability density function. 
Thus it indicates the probability the random variables will take on values less
than y, i.e. $P(Y<y)$. 
Since the probability density function for the uniform is constant, 
the integral is simply zero from negative infinite up to a, 
then a straight line from (a,0) up to (b,1) and then constant after that.

```{r}
curve(punif(x, min = a, max = b), from = -1, to = 2,
      xlab='y', ylab='f(y)', main='Cumulative distribution function for Unif(0,1)')
```
 
#### Quantile function

The quantile function is the inverse of the cumulative distribution function.
For a given probability p, it finds the value such that the 
probability the random variable is below that value is p.

```{r}
curve(qunif(x, min = a, max = b), from = 0, to = 1,
      xlab='y', ylab='f(y)', main='Quantile function for Unif(0,1)')
```

#### Random draw function

To draw random values from the distribution, use the `r` version of the 
function.
For instance, here is 100 random Unif(a,b) draws represented as a histogram.

```{r}
random_uniforms <- runif(100, min = a, max = b)
hist(random_uniforms, probability = TRUE)
```
