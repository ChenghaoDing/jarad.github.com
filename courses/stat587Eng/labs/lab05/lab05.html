<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Binomial probability of success estimation</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<p>To follow along, use the <a href="lab05.R">lab05 code</a>.</p>

<pre><code class="r">library(&quot;tidyverse&quot;)
</code></pre>

<pre><code>## -- Attaching packages ---------------------------------- tidyverse 1.3.0 --
</code></pre>

<pre><code>## v ggplot2 3.3.2     v purrr   0.3.4
## v tibble  3.0.3     v dplyr   1.0.1
## v tidyr   1.1.1     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0
</code></pre>

<pre><code>## -- Conflicts ------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
</code></pre>

<p>For reproducibility, set the seed.</p>

<pre><code class="r">set.seed(20190219)
</code></pre>

<h2>Binomial probability of success estimation</h2>

<p>Let&#39;s let \( y\sim Bin(n,\theta) \). 
Recall that the MLE is \( \hat{\theta}_{MLE} = \frac{y}{n} \).
If we assume the prior \( \theta \sim Be(a,b) \), then the posterior is 
\( \theta|y \sim Be(a+y,b+n-y) \)
and the posterior expectation is 
\[  \hat{\theta}_{Bayes} = E[\theta|y] = \frac{a+y}{a+b+n}.  \] 
Specifically, if we assume a Uniform prior on (0,1), i.e. \( a=b=1 \), then 
\( \theta|y \sim Be(1+y,1+n-y) \)
and the posterior expectation is 
\[  \hat{\theta}_{Bayes} = E[\theta|y] = \frac{1+y}{2+n}.  \] 
This is equivalent to adding one success and one failure to the data.</p>

<p>Suppose you randomly sample 22 buildings in Ames and find that 15 of them are 
residential buildings.
Then the MLE for the probability of a building in Ames being residential is </p>

<pre><code class="r">n &lt;- 22
y &lt;- 15
(mle &lt;- y/n)
</code></pre>

<pre><code>## [1] 0.6818182
</code></pre>

<p>the Bayes estimator is </p>

<pre><code class="r">a &lt;- b &lt;- 1
(bayes &lt;- (a+y)/(a+b+n))
</code></pre>

<pre><code>## [1] 0.6666667
</code></pre>

<p>and a 95\% credible interval is </p>

<pre><code class="r">qbeta(c(.025,.975), a+y, b+n-y)
</code></pre>

<pre><code>## [1] 0.4708083 0.8362364
</code></pre>

<h4>Binomial posterior activity</h4>

<p>Suppose that you take a larger sample of buildings and find that out of 
222 buildings 135 of them are residential. 
Calculate the MLE, Bayes estimator, and a 90\% credible interval for the probability of 
a house in Ames being residential.</p>

<p><details><summary>Click for solution</summary>  </p>

<pre><code class="r">n &lt;- 222
y &lt;- 135
(mle &lt;- y/n)
</code></pre>

<pre><code>## [1] 0.6081081
</code></pre>

<pre><code class="r">(bayes &lt;- (a+y)/(a+b+n))
</code></pre>

<pre><code>## [1] 0.6071429
</code></pre>

<pre><code class="r">qbeta(c(.05,.95), a+y, b+n-y) 
</code></pre>

<pre><code>## [1] 0.5530313 0.6601642
</code></pre>

<p>Can you calculate a posterior median?
</details></p>

<h2>Parameter estimation</h2>

<p>Recall that estimators have the properties</p>

<ul>
<li><a href="https://en.wikipedia.org/wiki/Bias_of_an_estimator">Bias</a></li>
<li><a href="https://en.wikipedia.org/wiki/Consistent_estimator">Consistency</a></li>
</ul>

<p>In addition, uncertainty intervals, i.e. credible intervals, have a property
called </p>

<ul>
<li><a href="https://en.wikipedia.org/wiki/Coverage_probability">Coverage</a></li>
</ul>

<h3>Bias</h3>

<p>The bias of an estimator is the expected value of the estimator minus the true
value. 
Generally, we don&#39;t know the true value, but we can simulate data with a known 
truth.
We can estimate the bias, by performing repeated simulations and taking the 
average value of the estimator across those simulations.
This average value is an estimate of the expected value.
If we take enough values in the average, then the Central Limit Theorem tells 
us the distribution of this average. 
Specifically</p>

<p>\[ \overline{x} \sim N(\mu,\sigma^2/n) \]
where \( \mu=E[\overline{x}] \) and we estimate \( \sigma^2 \) with the sample variance.</p>

<h4>Binomial model</h4>

<p>Let&#39;s use simulations, i.e. Monte Carlo, to estimate the bias 
of the MLE and Bayes estimator. 
To do this, we are going to repeatedly </p>

<ol>
<li>simulate binomial random variables with \( n=10 \) and \( \theta=0.5 \),</li>
<li>compute the MLE and Bayes estimator</li>
</ol>

<p>Then we will </p>

<ol>
<li>take an average of all the MLE estimates and subtract \( \theta \) (the true value)</li>
<li>take an average of all the Bayes estimates and subtract \( \theta \) (the true value)</li>
</ol>

<pre><code class="r">n &lt;- 10
theta &lt;- 0.5

n_reps &lt;- 1e4
mle &lt;- numeric(n_reps)
bayes &lt;- numeric(n_reps)

for (i in 1:n_reps) {
  y &lt;- rbinom(1, size = n, prob = theta)
  mle[i] &lt;- y/n
  bayes[i] &lt;- (a+y)/(a+b+n)
}


mean(mle)  - theta # estimate of MLE bias
</code></pre>

<pre><code>## [1] 0.00096
</code></pre>

<pre><code class="r">mean(bayes)- theta # estimate of Bayes bias
</code></pre>

<pre><code>## [1] 8e-04
</code></pre>

<p>Now, we probably want some idea of how close we are to the true bias.
We will use the CLT. 
\[  \overline{\hat{\theta}} \pm z_{0.025} SE(\overline{\hat{\theta}})  \]
where the \( SE(\overline{\hat{\theta}}) \) is estimated by the sample standard 
deviation of \( \hat{\theta} \) divided by the square root of the number of values
in the average, i.e. the sample size.
The formula for a 95% interval is then 
\[  \overline{\hat{\theta}} \pm z_{0.025} s_{\hat{\theta}}/\sqrt{n}  \]</p>

<pre><code class="r">mean(mle  ) + c(-1,1)*qnorm(.975)*sd(mle  )/sqrt(length(mle  )) - theta
</code></pre>

<pre><code>## [1] -0.002153667  0.004073667
</code></pre>

<pre><code class="r">mean(bayes) + c(-1,1)*qnorm(.975)*sd(bayes)/sqrt(length(bayes)) - theta
</code></pre>

<pre><code>## [1] -0.001794722  0.003394722
</code></pre>

<p>We could have written the code a bit more succinctly (and, perhaps, obtusely).</p>

<pre><code class="r">y &lt;- rbinom(n_reps, size = n, prob = theta)
mle   &lt;- y/n
bayes &lt;- (a+y)/(a+b+n)

mean(mle  ) + c(-1,1)*qnorm(.975)*sd(mle  )/sqrt(length(mle  )) - theta
</code></pre>

<pre><code>## [1] -0.002545906  0.003605906
</code></pre>

<pre><code class="r">mean(bayes) + c(-1,1)*qnorm(.975)*sd(bayes)/sqrt(length(bayes)) - theta
</code></pre>

<pre><code>## [1] -0.002121588  0.003004922
</code></pre>

<h4>Binomial bias activity</h4>

<p>Repeat the simulation procedure we had above, but using \( n=5 \) and \( \theta=0.2 \).
What do you find for the bias of the MLE and the Bayes estimator?</p>

<p><details><summary>Click for solution</summary>  </p>

<pre><code class="r">n &lt;- 5
theta &lt;- 0.2

y &lt;- rbinom(n_reps, size = n, prob = theta)
mle   &lt;- y/n
bayes &lt;- (a+y)/(a+b+n)

mean(mle  ) + c(-1,1)*qnorm(.975)*sd(mle  )/sqrt(length(mle  )) - theta
</code></pre>

<pre><code>## [1] -0.004077641  0.002877641
</code></pre>

<pre><code class="r">mean(bayes) + c(-1,1)*qnorm(.975)*sd(bayes)/sqrt(length(bayes)) - theta
</code></pre>

<pre><code>## [1] 0.08280169 0.08776974
</code></pre>

<p>So the Bayes estimator appears to be quite biased.
</details></p>

<h4>Binomial bias simulation study</h4>

<p>Let&#39;s study what happens to the bias of the Bayes estimator as we change \( n \) 
and \( \theta \). 
The following will look at \( n=1,10,100,1000 \) and \( \theta \) from \( 0 \) to \( 1 \) in 
increments of 0.1. </p>

<pre><code class="r">settings &lt;- expand.grid(n = 10^(0:3),
                        theta = seq(0,1,by=0.1))
</code></pre>

<p>We will use the <a href="https://cran.r-project.org/web/packages/dplyr/index.html">dplyr</a>
package to help us iterate over all of these values of \( n \) and \( \theta \). 
First we need to construct the function to do a simulation study for every value
of <code>n</code> and <code>theta</code>.</p>

<pre><code class="r">sim_function &lt;- function(x) {
  y     &lt;- rbinom(1e4, size = x$n, prob = x$theta)
  mle   &lt;- y/x$n
  bayes &lt;- (a+y)/(a+b+x$n)

  d &lt;- data.frame(
    estimator = c(&quot;mle&quot;, &quot;bayes&quot;),
    bias      = c(mean(mle), mean(bayes)) - x$theta,
    var       = c(var( mle), var( bayes)))

  # d$se    &lt;- sqrt(d$var / x$n)
  # d$lower &lt;- d$bias-qnorm(.975)*d$se
  # d$upper &lt;- d$bias+qnorm(.975)*d$se

  return(d)
}
</code></pre>

<p>Then we can loop over all the values of <code>n</code> and <code>theta</code>. </p>

<pre><code class="r">sim_study &lt;- settings %&gt;% 
  group_by(n, theta) %&gt;%
  do(sim_function(.))
</code></pre>

<p>Let&#39;s plot the Monte Carlo estimated bias.</p>

<pre><code class="r">ggplot(sim_study, aes(x=theta, y=bias, color=estimator)) +
  geom_line() +
  facet_wrap(~n) + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/></p>

<p>We can see that the Bayes estimator has the most bias when 1) the sample size
is small and 2) \( \theta \) is far away from 0.5.
But the variance of the Bayes estimator is smaller than the variance of the 
MLE estimator.</p>

<pre><code class="r">ggplot(sim_study, aes(x=theta, y=var, color=estimator)) +
  geom_line() +
  facet_wrap(~n) + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/></p>

<p>We can see that the Bayes estimator always has smaller variance than the MLE.</p>

<p>Thus, we often use a new property of an estimator called the 
<a href="https://en.wikipedia.org/wiki/Mean_squared_error">mean squared error (MSE)</a>:
\[  MSE(\hat{\theta}) = 
E[(\hat\theta-\theta)^2] = 
Var(\hat{\theta}) + Bias(\hat{\theta},\theta)^2  \]
This property combines both the bias and the variance into a single term.
Generally the estimator with the smallest MSE should be utilized.</p>

<pre><code class="r">sim_study$mse &lt;- sim_study$var + sim_study$bias^2

ggplot(sim_study, aes(x=theta, y=mse, color=estimator)) +
  geom_line() +
  facet_wrap(~n) + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/></p>

<h4>Binomial MSE activity</h4>

<p>Generate a curve for the MSE for the MLE and Bayes estimators for a 
binomial probability of success when \( n=13 \) for various values of \( \theta \).</p>

<p><details><summary>Click for solution</summary> </p>

<pre><code class="r">settings &lt;- expand.grid(n = 13,
                        theta = seq(0,1,by=0.1))

sim_study &lt;- settings %&gt;% 
  group_by(n, theta) %&gt;%
  do(sim_function(.))

sim_study$mse &lt;- sim_study$var + sim_study$bias^2

ggplot(sim_study, aes(x=theta, y=mse, color=estimator)) +
  geom_line() +
  facet_wrap(~n) + # This line isn&#39;t necessary
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-17"/></p>

<p>Why does the alternative approach give the same answer?
(I&#39;m not sure what I mean by this.)
</details></p>

<h3>Consistency</h3>

<p>Recall that an estimator is consistent if 
\[  
P(|\hat\theta_n-\theta|<\epsilon) \to 1 \quad\mbox{ as }\quad n\to\infty
 \]
for any \( \epsilon>0 \).
Here I have made explicit that the estimator depends on \( n \). </p>

<p>To evaluate consistency by simulation, 
we will perform a sequence of experiments, 
i.e. one coin flip at a time, 
and calculate the estimator after each coin flip.
Then we will see how many times the estimator is more than \( \epsilon \) away 
from \( \theta \).</p>

<pre><code class="r">theta = 0.51
n_max &lt;- 999

sim_function &lt;- function(d) {
  x &lt;- rbinom(n_max, size = 1, prob = theta)

  mle &lt;- bayes &lt;- numeric(n_max)
  for (n in 1:n_max) {
    y &lt;- sum(x[1:n])
    mle[n] &lt;- y/n
    bayes[n] &lt;- (a+y)/(a+b+n)
  }

  data.frame(n     = 1:n_max,
             mle   = mle,
             bayes = bayes)
}

d &lt;- data.frame(rep=1:1e3) %&gt;%
  group_by(rep) %&gt;%
  do(sim_function(.))

epsilon &lt;- 0.05
sum &lt;- d %&gt;% 
  gather(estimator, estimate, mle, bayes) %&gt;%
  group_by(n, estimator) %&gt;%
  summarize(prob = mean(abs(estimate - theta) &lt; epsilon))
</code></pre>

<pre><code>## `summarise()` regrouping output by &#39;n&#39; (override with `.groups` argument)
</code></pre>

<p>Now plot the results</p>

<pre><code class="r">ggplot(sum, aes(x=n, y=prob, 
                color=estimator, linetype = estimator)) + 
  geom_line() +
  theme_bw() 
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-19"/></p>

<p>This is an illustration of the property called consistency. 
For both the Bayes estimator and the MLE, 
the probability of being within \( \epsilon \) of \( \theta \) (the true success 
probability) converges to 1 as the number of observations increases.</p>

<h4>Binomial consistency activity</h4>

<p>Via simulation, show that if \( \theta=0.01 \) that both the MLE and Bayes 
estimators are consistent.</p>

<p><details><summary>Click for solution</summary>  </p>

<pre><code class="r">theta = 0.01

d &lt;- data.frame(rep=1:1e3) %&gt;%
  group_by(rep) %&gt;%
  do(sim_function(.))

sum &lt;- d %&gt;% 
  gather(estimator, estimate, mle, bayes) %&gt;%
  group_by(n, estimator) %&gt;%
  summarize(prob = mean(abs(estimate - theta) &lt; epsilon))
</code></pre>

<pre><code>## `summarise()` regrouping output by &#39;n&#39; (override with `.groups` argument)
</code></pre>

<pre><code class="r">ggplot(sum, aes(x = n, y = prob, color = estimator, linetype = estimator)) + 
  geom_line() +
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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8PVhH/BGjPhPEj59C0YYInx92IeHP130oizh68Q+PHz6FowwRPj6sPwcn481UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVCoafjgJ+TwYUSVDSs+H2ugUNMVP3sH4atlCZ+PNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQMA//6W3neXLd/6Xzw0l84+lB+HEJXy1bevjebnTUja/Pu9H5bv/VwsclfLVs6eEvDpL26fS6ty87zy7jB40n+Ak5fBhRZVN6+OP78P29y/ir29fpDVa8mK1uxfd/PUmuht8FhBezlR3jb386SQ/0vW74cQlfLVvNWX38LH/U6XR2R6f4hJez/ByfjzVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVCoafjgB6XwmTSVDSs+H2ugUNMVP3sH4atlCZ+PNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQILyCNVAgvII1UCC8gjVQMA//6W3n+f316Abh5Wzp4Xu70VF3dD26QXg5W3r4i4Ok+fB6eONRPLMfjnOVjuJjeZo5pYc/HoZPr0c3Fq34jGPAGijUcMWHHtdy71grmId/0DE+4xiwBgrm4dMT+f7eZaaz+oxjwBoomIdfMIQXs4TPxxooEF7BGigQXsEaKBBewRooEF7BGigQXsEaKBBewRooEF7BGigQXsEaKBBewRooEF7BGigQXsEaKBBewRooEF7BGigQXsEaKNQ0PCMeUfi5KVSk/O3WTLe07Q6G8I3b7mA+JzxT4yF8Q4fwDR3CN3Ryhx+/376w6f/S+eEk3u7Tg0I3Pt5isc7nnU5nt3jd6Lw78e8pl7CbB5M7/PjfsCls4n/i893+q6I3Pt5i4c7vT4rXPep0J2xL2M2DyR1+/O/UFTm97u3LzrPLQjc+3mLRzvHGCtft/xF//49ty9nN0WeEPy7DqL93mezM14VufLzFop3fn0TF6yZPfGPbUnZzMlYrvv/rSXJVxtIsY/nc/jy58cI2a77iSzj43P50kv5j94o9so23WLBzUqR43XSTxsf4Ek43j4anyQWfy5Z2ihwXKmO75mf1TL2H8A0dwjd0CN/QIXxDh/ANHcI3dAjf0GlK+JvvtlsbagmnaUz4bw7vXhyqLYymMeE3zz7+tq+2MBrCN3QI39AhfEOnKeGZmSF8Q4fwDR3CN3QI39AhfEOH8A2d/wO2zrN24UfF0AAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-20"/>
</details></p>

<h3>Coverage</h3>

<p>Uncertainty intervals have a property called 
<a href="https://en.wikipedia.org/wiki/Coverage_probability">coverage</a>.
Coverage is the probability the interval will contain the truth when the method
used to construct the interval is used repeatedly on different data sets.</p>

<p>We will evaluate coverage using simulations by repeatedly</p>

<ol>
<li>Simulating data</li>
<li>Creating a credible interval</li>
<li>Determining how often that credible interval contains the truth</li>
</ol>

<pre><code class="r">n &lt;- 100
theta &lt;- 0.5

n_reps &lt;- 1e4
y &lt;- rbinom(n_reps, size = n, prob = theta)

lower &lt;- qbeta(.025, a+y, b+n-y)
upper &lt;- qbeta(.975, a+y, b+n-y)

mean( lower &lt; theta &amp; theta &lt; upper )
</code></pre>

<pre><code>## [1] 0.9407
</code></pre>

<p>If we want to understand our Monte Carlo uncertainty in this coverage, 
we can use the CLT for a proportion.</p>

<pre><code class="r">p &lt;- mean( lower &lt; theta &amp; theta &lt; upper)

p + c(-1,1)*qnorm(.975)*sqrt(p*(1-p)/n_reps)
</code></pre>

<pre><code>## [1] 0.9360709 0.9453291
</code></pre>

<h4>Binomial coverage activity</h4>

<p>Via simulation, determine the coverage for a credible interval when \( n=10 \) and
\( \theta = 0.2 \) and use the CLT to provide an uncertainty on this coverage.</p>

<p><details><summary>Click for solution</summary> </p>

<pre><code class="r">n &lt;- 10
theta &lt;- 0.2

n_reps &lt;- 1e4
y &lt;- rbinom(n_reps, size = n, prob = theta)

lower &lt;- qbeta(.025, a+y, b+n-y)
upper &lt;- qbeta(.975, a+y, b+n-y)

(p &lt;- mean( lower &lt; theta &amp; theta &lt; upper))
</code></pre>

<pre><code>## [1] 0.9695
</code></pre>

<pre><code class="r">p + c(-1,1)*qnorm(.975)*sqrt(p*(1-p)/n_reps)
</code></pre>

<pre><code>## [1] 0.9661297 0.9728703
</code></pre>

<p>Now try with \( \theta=0.01 \). </p>

<p></details></p>

<h4>Binomial coverage simulation study</h4>

<p>Let&#39;s now look at coverage across a wide range of \( n \) and \( \theta \). </p>

<pre><code class="r">binomial_coverage_function &lt;- function(d) {
  y     &lt;- rbinom(1e4, size = d$n, prob = d$theta)
  mle   &lt;- y/d$n
  bayes &lt;- (a+y)/(a+b+d$n)

  lower &lt;- qbeta(.025, a+y, b+d$n-y)
  upper &lt;- qbeta(.975, a+y, b+d$n-y)

  data.frame(coverage = mean( lower &lt;= d$theta &amp; d$theta &lt;= upper))
}

sim_study &lt;- expand.grid(n = 10^(0:3),
                        theta = seq(0,1,by=0.1)) %&gt;%
  group_by(n,theta) %&gt;%
  do(binomial_coverage_function(.))
</code></pre>

<p>Now plot the results</p>

<pre><code class="r">ggplot(sim_study, aes(x=theta, y=coverage)) +
  geom_line() +
  facet_wrap(~n) + 
  geom_hline(yintercept = 0.95, color = &quot;red&quot;) +
  ylim(0,1) + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-25"/></p>

<p>The coverage is extremely poor when \( \theta \) is 0 (or 1) because \( y \) is always 
0 (or \( n \)). 
In these cases, a simple way to fix the interval is to use a one-sided interval
when \( y \) is 0 (or \( n \)). 
Specifically,</p>

<ul>
<li>if \( y=0 \), then use the one-sided interval (0,U)</li>
<li>if \( y=n \), then use the one-sided interval (L,1)</li>
</ul>

<pre><code class="r">binomial_coverage_function_fixed &lt;- function(d) {
  n &lt;- d$n
  theta &lt;- d$theta
  y     &lt;- rbinom(1e4, size = n, prob = theta)
  mle   &lt;- y/d$n
  bayes &lt;- (a+y)/(a+b+n)

  lower &lt;- qbeta(.025, a+y, b+n-y)
  upper &lt;- qbeta(.975, a+y, b+n-y)

  # Fix intervals when y=0
  lower[y==0] &lt;- 0
  upper[y==0] &lt;- qbeta(.95, a+0, b+n)

  # Fix intervals when y=n
  upper[y==n] &lt;- 1
  lower[y==n] &lt;- qbeta(.05, a+n, b+0)

  data.frame(coverage = mean( lower &lt;= theta &amp; theta &lt;= upper))
}

sim_study &lt;- expand.grid(n = 10^(0:3),
                        theta = seq(0,1,by=0.1)) %&gt;%
  group_by(n,theta) %&gt;%
  do(binomial_coverage_function_fixed(.))
</code></pre>

<p>Now plot the results</p>

<pre><code class="r">ggplot(sim_study, aes(x=theta, y=coverage)) +
  geom_line() +
  facet_wrap(~n) + 
  geom_hline(yintercept = 0.95, color = &quot;red&quot;) +
  ylim(0,1) + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-27"/></p>

<p>The plot here has been constructed to have y-axis limits set to 0 and 1 for
comparison with the previous plot.</p>

<h4>Coverage for Jeffreys prior</h4>

<p>In this class, we will use a uniform prior for the probability. 
An alternative is to use Jeffreys prior which is \( Be(0.5,0.5) \). 
Run a simulation study to look at coverage for Jeffreys prior. </p>

<p><details><summary>Click for solution</summary>  </p>

<pre><code class="r">a &lt;- b &lt;- 0.5

sim_study &lt;- expand.grid(n = 10^(0:3),
                        theta = seq(0,1,by=0.1)) %&gt;%
  group_by(n,theta) %&gt;%
  do(binomial_coverage_function_fixed(.))

ggplot(sim_study, aes(x=theta, y=coverage)) +
  geom_line() +
  facet_wrap(~n) + 
  geom_hline(yintercept = 0.95, color = &quot;red&quot;) +
  ylim(0,1) + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-28"/>
</details></p>

</body>

</html>

