<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Normal data</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<p>To follow along, use the <a href="lab06.R">lab06 code</a>.
Set your working directory using 
Session &gt; Set Working Directory &gt; Choose Directory in RStudio or using the 
<code>setwd()</code> function.
You can also save <a href="creativity.csv">creativity.csv</a> into your working directory
if you want.</p>

<h2>Normal data</h2>

<h3>Background</h3>

<p>Suppose \( Y_i\stackrel{ind}{\sim} N(\mu,\sigma^2) \). 
Recall that a Bayesian analysis with the default prior 
\( p(\mu,\sigma^2) \propto 1/\sigma^2 \) provides the same analysis for \( \mu \) as a
non-Bayesian analysis. 
That is </p>

<ul>
<li>MLE and the posterior mean/median for \( \mu \) are the same</li>
<li>confidence and credible intervals for \( \mu \) are exactly the same</li>
</ul>

<p>This is because the posterior for \( \mu \) is 
\[ 
\mu|y \sim t_{n-1}(\overline{y}, s^2/n)
 \]
which means that 
\[ 
\left.\frac{\mu-\overline{y}}{s/\sqrt{n}} \right|y \sim t_{n-1}(0,1).
 \]
while the sampling distribution for \( \overline{y} \) is such that 
\[ 
T=\left.\frac{\overline{Y}-\mu}{S/\sqrt{n}} \right|y \sim t_{n-1}(0,1).
 \]</p>

<p>Please note the difference in these two statements is what is considered 
random.
In the first two \( \mu \) is considered random while the data which are used to
calculate \( \overline{y} \) and \( s \) are fixed.
This does not mean that a Bayesian considered the actual true value of \( \mu \) to
be random. Instead it means that we are expressing our uncertainty in \( \mu \) 
through probability.
In the last statement, the data are considered random 
which is why \( \overline{Y} \) and \( S \) are capitalized while \( \mu \) is considered 
fixed.</p>

<h3>Manual analysis</h3>

<p>Suppose you observe the following data</p>

<pre><code class="r">set.seed(20180219)
(y &lt;- rnorm(10, mean = 3.2, sd = 1.1)) # 3.2 and 1.1 are the population parameters
</code></pre>

<pre><code>##  [1] 1.974293 4.759967 2.812764 0.758789 2.256666 4.880966 3.732871 3.929907
##  [9] 4.613458 1.649653
</code></pre>

<p>Then you can manually construct an MLE and posterior mean using <code>mean()</code>.</p>

<pre><code class="r">(ybar &lt;- mean(y))
</code></pre>

<pre><code>## [1] 3.136933
</code></pre>

<p>and a 95% credible/confidence interval using</p>

<pre><code class="r">n &lt;- length(y)
s &lt;- sd(y)

ybar + c(-1,1)*qt(.975, df = n-1)*s/sqrt(n)
</code></pre>

<pre><code>## [1] 2.099208 4.174659
</code></pre>

<h3>Built-in analysis</h3>

<p>You can use the <code>t.test()</code> function to perform this for you.</p>

<pre><code class="r">t.test(y)
</code></pre>

<pre><code>## 
##  One Sample t-test
## 
## data:  y
## t = 6.8383, df = 9, p-value = 7.572e-05
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  2.099208 4.174659
## sample estimates:
## mean of x 
##  3.136933
</code></pre>

<p>You can extract the estimates and confidence/credible intervals,
but first you need to know how to access the appropriate objects within the
t-test object.</p>

<pre><code class="r">tt &lt;- t.test(y)
names(tt)
</code></pre>

<pre><code>##  [1] &quot;statistic&quot;   &quot;parameter&quot;   &quot;p.value&quot;     &quot;conf.int&quot;    &quot;estimate&quot;   
##  [6] &quot;null.value&quot;  &quot;stderr&quot;      &quot;alternative&quot; &quot;method&quot;      &quot;data.name&quot;
</code></pre>

<pre><code class="r">str(tt)
</code></pre>

<pre><code>## List of 10
##  $ statistic  : Named num 6.84
##   ..- attr(*, &quot;names&quot;)= chr &quot;t&quot;
##  $ parameter  : Named num 9
##   ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;
##  $ p.value    : num 7.57e-05
##  $ conf.int   : num [1:2] 2.1 4.17
##   ..- attr(*, &quot;conf.level&quot;)= num 0.95
##  $ estimate   : Named num 3.14
##   ..- attr(*, &quot;names&quot;)= chr &quot;mean of x&quot;
##  $ null.value : Named num 0
##   ..- attr(*, &quot;names&quot;)= chr &quot;mean&quot;
##  $ stderr     : num 0.459
##  $ alternative: chr &quot;two.sided&quot;
##  $ method     : chr &quot;One Sample t-test&quot;
##  $ data.name  : chr &quot;y&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;
</code></pre>

<p>It isn&#39;t always obvious what object we want and thus we often need to just look
at all of them until we figure out which ones we need. 
In this case, <code>conf.int</code> seems like a good guess for the confidence/credible
intervals. 
It turns out that <code>estimate</code> will gives us the MLE and posterior mean/median.</p>

<pre><code class="r">tt$estimate
</code></pre>

<pre><code>## mean of x 
##  3.136933
</code></pre>

<pre><code class="r">tt$conf.int
</code></pre>

<pre><code>## [1] 2.099208 4.174659
## attr(,&quot;conf.level&quot;)
## [1] 0.95
</code></pre>

<h4>Modifying arguments</h4>

<p>We can also change the default argument values to</p>

<ul>
<li>change the type of hypothesis test</li>
<li>change the null value</li>
<li>change the confidence level</li>
</ul>

<p>Suppose we wanted to test \( H_0:\mu\ge 1 \) vs \( H_a:\mu < 1 \) at a signficance
level of 0.9 and/or we wanted to construct a 90\% one-sided lower
confidence interval.</p>

<pre><code class="r">t.test(y, alternative = &quot;less&quot;,    mu = 1,  conf.level = 0.9)
</code></pre>

<pre><code>## 
##  One Sample t-test
## 
## data:  y
## t = 4.6583, df = 9, p-value = 0.9994
## alternative hypothesis: true mean is less than 1
## 90 percent confidence interval:
##      -Inf 3.771374
## sample estimates:
## mean of x 
##  3.136933
</code></pre>

<p>Suppose we wanted to test \( H_0:\mu\le -1 \) vs \( H_a:\mu > -1 \) at a signficance
level of 0.99 and/or we wanted to construct a 99\% one-sided upper
confidence interval.</p>

<pre><code class="r">t.test(y, alternative = &quot;greater&quot;, mu = -1, conf.level = 0.99)
</code></pre>

<pre><code>## 
##  One Sample t-test
## 
## data:  y
## t = 9.0182, df = 9, p-value = 4.199e-06
## alternative hypothesis: true mean is greater than -1
## 99 percent confidence interval:
##  1.842647      Inf
## sample estimates:
## mean of x 
##  3.136933
</code></pre>

<h4>Activity</h4>

<p>Using the following data, compare the point estimate and confidence/credible
intervals obtained using the <code>t.test()</code> function to estimates and 
intervals you create yourself.</p>

<p>If you have more time, try to play around with the function arguments to create
one-sided confidence intervals, change the null hypothesis value, 
and change the confidence/significance level.</p>

<pre><code class="r">set.seed(1)
y &lt;- rnorm(1001, mean = 256, sd = 34.6)
</code></pre>

<p><details><summary>Click for solution</summary> </p>

<pre><code class="r">t.test(y)
</code></pre>

<pre><code>## 
##  One Sample t-test
## 
## data:  y
## t = 225.84, df = 1000, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  253.4154 257.8578
## sample estimates:
## mean of x 
##  255.6366
</code></pre>

<pre><code class="r">mean(y)
</code></pre>

<pre><code>## [1] 255.6366
</code></pre>

<pre><code class="r">mean(y) + c(-1,1)*qt(.975, df = length(y)-1)*sd(y)/sqrt(length(y))
</code></pre>

<pre><code>## [1] 253.4154 257.8578
</code></pre>

<p></details></p>

<h2>Binomial data</h2>

<h3>Bayesian analysis</h3>

<p>Let \( Y\sim Bin(n,\theta) \).
Recall that our default prior for \( \theta \) is \( \theta \sim Be(1,1) \), which is
equivalent to a \( Unif(0,1) \) prior.
The posterior under this prior is \( \theta|y \sim Be(1+y,1+n-y) \). 
In order to perform this analysis, 
we simply use the beta distribution in R. </p>

<p>Suppose you observe 9 successes out of 13 attempts. </p>

<pre><code class="r">a &lt;- b &lt;- 1
n &lt;- 13
y &lt;- 9
</code></pre>

<p>The posterior is </p>

<pre><code class="r">curve(dbeta(x, a+y, b+n-y))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/></p>

<p>The posterior expectation is </p>

<pre><code class="r">(a+y)/(a+b+n)
</code></pre>

<pre><code>## [1] 0.6666667
</code></pre>

<p>A 95\% equal-tail credible interval is </p>

<pre><code class="r">qbeta(c(.025,.975), a+y, b+n-y)
</code></pre>

<pre><code>## [1] 0.4189647 0.8724016
</code></pre>

<p>The probability that \( \theta \) is greater than 0.5, i.e. \( P(\theta>0.5|y) \) is </p>

<pre><code class="r">1-pbeta(0.5, a+y, b+n-y)
</code></pre>

<pre><code>## [1] 0.9102173
</code></pre>

<h4>Jeffreys prior activity</h4>

<p>An alternative prior is called Jeffreys prior and it corresponds to a 
Be(0.5,0.5) prior. 
Suppose you observed 17 successes out of 20 attempts and you are willing to assume 
independence and a common probability of success.
Use Jeffreys prior on this probability of success to do the following </p>

<ul>
<li>Plot the posterior for the true probability of success</li>
<li>Calculate the posterior median for the true probability of success</li>
<li>Calculate a one-sided upper 95% credible interval for the true probability of success</li>
<li>Calculate the probability that the true probability of success is greater than 0.9.</li>
</ul>

<p><details><summary>Click for solution</summary>  </p>

<pre><code class="r">a &lt;- b &lt;- 0.5
n &lt;- 20
y &lt;- 17
curve(dbeta(x, a+y, b+n-y))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/></p>

<pre><code class="r">qbeta(0.5, a+y, b+n-y)
</code></pre>

<pre><code>## [1] 0.8439957
</code></pre>

<pre><code class="r">c(qbeta(0.05, a+y, b+n-y), 1)
</code></pre>

<pre><code>## [1] 0.6863196 1.0000000
</code></pre>

<pre><code class="r">1-pbeta(0.9, a+y, b+n-y)
</code></pre>

<pre><code>## [1] 0.2137305
</code></pre>

<p></details></p>

<h3>Non-Bayesian analyses when n is small</h3>

<p>To perform non-Bayesian analyses when n is small,
use the <code>binom.test</code> function.
This will calculate pvalues and confidence intervals 
(based on inverting hypothesis tests).</p>

<p>Suppose you observe 9 successes out of 13 attempts. </p>

<pre><code class="r">n &lt;- 13
y &lt;- 9
binom.test(y, n)
</code></pre>

<pre><code>## 
##  Exact binomial test
## 
## data:  y and n
## number of successes = 9, number of trials = 13, p-value = 0.2668
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.3857383 0.9090796
## sample estimates:
## probability of success 
##              0.6923077
</code></pre>

<p>This is equivalent to calculating the probability of observing y equal to 
0, 1, 2, 3, 4, 9, 10, 11, 12, 13 if \( \theta \) is 0.5.</p>

<pre><code class="r">sum(dbinom(c(0:4,9:13), size = n, prob = 0.5))
</code></pre>

<pre><code>## [1] 0.2668457
</code></pre>

<p>Recall that there is a one-to-one correspondence between pvalues and confidence
intervals.
This confidence interval is constructed by finding those values for \( \theta \)
such that the pvalue is half of the confidence level
(since it is a two-sided interval).</p>

<pre><code class="r">ci &lt;- binom.test(y,n)$conf.int
binom.test(y, n, p=ci[2])$p.value # This one matches exactly
</code></pre>

<pre><code>## [1] 0.025
</code></pre>

<pre><code class="r">binom.test(y, n, p=ci[1])$p.value # This one is close
</code></pre>

<pre><code>## [1] 0.04124282
</code></pre>

<h4>binom.test Activity</h4>

<p>Suppose you observe 11 successes out of 12 attempts. 
Calculate a pvalue for the two-sided test that \( \theta=0.5 \) and construct
a 95\% confidence interval.</p>

<p><details><summary>Click for solution</summary> </p>

<pre><code class="r">binom.test(11,12)
</code></pre>

<pre><code>## 
##  Exact binomial test
## 
## data:  11 and 12
## number of successes = 11, number of trials = 12, p-value = 0.006348
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.6152038 0.9978924
## sample estimates:
## probability of success 
##              0.9166667
</code></pre>

<p></details></p>

<h3>Non-Bayesian analyses when n is large (and p is not close to 0 or 1)</h3>

<p>If you observe 78 successes out of 100 attempts, 
then you can use the <code>prop.test()</code> function to generate a number of statistics
automatically based on the CLT.</p>

<pre><code class="r">n &lt;- 100
y &lt;- 78
prop.test(y,n)
</code></pre>

<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  y out of n, null probability 0.5
## X-squared = 30.25, df = 1, p-value = 3.798e-08
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.6838686 0.8541734
## sample estimates:
##    p 
## 0.78
</code></pre>

<p>The estimate is </p>

<pre><code class="r">pt &lt;- prop.test(y,n)
pt$estimate
</code></pre>

<pre><code>##    p 
## 0.78
</code></pre>

<p>An approximate 95\% confidence interval is </p>

<pre><code class="r">pt$conf.int
</code></pre>

<pre><code>## [1] 0.6838686 0.8541734
## attr(,&quot;conf.level&quot;)
## [1] 0.95
</code></pre>

<p>We can construct this ourself using the following formula</p>

<pre><code class="r">p &lt;- y/n
p + c(-1,1)*qnorm(.975)*sqrt(p*(1-p)/n)
</code></pre>

<pre><code>## [1] 0.6988092 0.8611908
</code></pre>

<p>The results don&#39;t quite match because <code>prop.test</code> uses the continuity correction
(which is the appropriate thing to do).</p>

<pre><code class="r">prop.test(y, n, correct = FALSE)
</code></pre>

<pre><code>## 
##  1-sample proportions test without continuity correction
## 
## data:  y out of n, null probability 0.5
## X-squared = 31.36, df = 1, p-value = 2.144e-08
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.6892965 0.8499872
## sample estimates:
##    p 
## 0.78
</code></pre>

<p>Unfortunately, the results still don&#39;t quite match.
It turns out there is a large literature on how to do this and the suggestions 
are to either 1) use Wilson&#39;s interval (which is what <code>prop.test</code> does) or to 
use 2) Jeffreys, i.e. a Beta(&frac12;,&frac12;) prior in a Bayesian analysis.</p>

<h4>Activity</h4>

<p>Suppose you observed 694 success out of 934 attempts. 
Compute an approximate 95\% equal-tail confidence interval using <code>prop.test</code> 
and compare this to a 95\% equal-tail confidence interval you construct using
the Central Limit Theorem.</p>

<p><details><summary>Click for solution</summary> </p>

<pre><code class="r">y &lt;- 694
n &lt;- 934
prop.test(y, n)$conf.int
</code></pre>

<pre><code>## [1] 0.7135099 0.7705425
## attr(,&quot;conf.level&quot;)
## [1] 0.95
</code></pre>

<pre><code class="r">p &lt;- y/n
p + c(-1,1)*qnorm(.975)*sqrt(p*(1-p)/n)
</code></pre>

<pre><code>## [1] 0.7150178 0.7710636
</code></pre>

<pre><code class="r"># If you turn off the continuity correction, you will get closer
prop.test(y, n, correct = FALSE)$conf.int
</code></pre>

<pre><code>## [1] 0.7140620 0.7700283
## attr(,&quot;conf.level&quot;)
## [1] 0.95
</code></pre>

<p>If you really want to figure out what the function is doing, 
you can look at the function by just typing <code>prop.test</code> and hitting enter.
</details></p>

<h4>Activity</h4>

<p>Suppose you observe 0 success out of 77 attempts. 
Compare 95% confidence intervals given by <code>prop.test</code> and <code>binom.test</code> to 
an interval you construct based on the CLT and to 95% credible intervals.</p>

<p><details><summary>Click for solution</summary> </p>

<p>So this is a bit of a trick question since there were 0 successes. 
When you run <code>prop.test</code> and <code>binom.test</code> you are given one-sided confidence 
intervals.
The CLT interval doesn&#39;t exist since the standard error is zero.
The appropriate credible interval to use is a one-sided interval.</p>

<pre><code class="r">y &lt;- 0
n &lt;- 77
prop.test(y, n)$conf.int
</code></pre>

<pre><code>## [1] 0.00000000 0.05921002
## attr(,&quot;conf.level&quot;)
## [1] 0.95
</code></pre>

<pre><code class="r">binom.test(y, n)$conf.int
</code></pre>

<pre><code>## [1] 0.00000000 0.04677807
## attr(,&quot;conf.level&quot;)
## [1] 0.95
</code></pre>

<pre><code class="r">qbeta(c(0,.95), 1+y, 1+n-y)
</code></pre>

<pre><code>## [1] 0.00000000 0.03767863
</code></pre>

<p></details></p>

<h2>Reading data from files</h2>

<p>First, let&#39;s write some data to a file. </p>

<pre><code class="r">set.seed(20180220)
# Generate some simulated data
n &lt;- 100
d &lt;- data.frame(rep = 1:n,
                response = sample(c(&quot;Yes&quot;,&quot;No&quot;), n, replace=TRUE, prob = c(.2,.8)),
                measurement = rnorm(n, mean = 55, sd = 12))

# Write it to a file
# make sure you have set your working directory to someplace where you want this
# file to be written
write.csv(d, 
          file = &quot;data.csv&quot;,
          row.names = FALSE)
</code></pre>

<p>Alternatively, you could use the <code>write_csv()</code> function in the 
<a href="https://cran.r-project.org/web/packages/readr/index.html">readr</a> package. </p>

<pre><code class="r">install.packages(&quot;readr&quot;)
library(&quot;readr&quot;) 
write_csv(d, path = &quot;data.csv&quot;)
</code></pre>

<p>Now let&#39;s read this data back in. </p>

<pre><code class="r">my_data &lt;- read.csv(&quot;data.csv&quot;)
</code></pre>

<p>Take a look at the data to make sure it looks correct:</p>

<pre><code class="r">head(my_data)
</code></pre>

<pre><code>##   rep response measurement
## 1   1       No    49.16525
## 2   2       No    66.62369
## 3   3       No    35.14872
## 4   4       No    61.15329
## 5   5       No    61.34038
## 6   6       No    53.79730
</code></pre>

<pre><code class="r">str(my_data)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    100 obs. of  3 variables:
##  $ rep        : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ response   : chr  &quot;No&quot; &quot;No&quot; &quot;No&quot; &quot;No&quot; ...
##  $ measurement: num  49.2 66.6 35.1 61.2 61.3 ...
</code></pre>

<h3>Binomial data</h3>

<p>To use <code>prop.test()</code> and <code>binom.test()</code>, 
you need to calculate the number of successes and the number of attempts.</p>

<pre><code class="r">y &lt;- sum(my_data$response == &quot;Yes&quot;)
n &lt;- length(my_data$response)
prop.test(y, n)
</code></pre>

<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  y out of n, null probability 0.5
## X-squared = 32.49, df = 1, p-value = 1.198e-08
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.1375032 0.3052597
## sample estimates:
##    p 
## 0.21
</code></pre>

<pre><code class="r">binom.test(y, n)
</code></pre>

<pre><code>## 
##  Exact binomial test
## 
## data:  y and n
## number of successes = 21, number of trials = 100, p-value = 4.337e-09
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.1349437 0.3029154
## sample estimates:
## probability of success 
##                   0.21
</code></pre>

<h3>Normal data</h3>

<p>To analyze the normal data, you can just use <code>t.test()</code> directly.</p>

<pre><code class="r">t.test(my_data$measurement)
</code></pre>

<pre><code>## 
##  One Sample t-test
## 
## data:  my_data$measurement
## t = 42.956, df = 99, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  50.91322 55.84453
## sample estimates:
## mean of x 
##  53.37888
</code></pre>

<h4>Online activity</h4>

<p>Read in the data at <a href="creativity.csv">creativity.csv</a> 
and then construct confidence/credible intervals for mean creativity score
for both the Intrinsic and Extrinsic groups. </p>

<p><details><summary>Click for solution</summary> </p>

<p>There are a variety of ways to do this. 
I will construct two new data frames to contain the Intrinsic and Extrinsic 
data and then construct the intervals.</p>

<pre><code class="r">creativity &lt;- read.csv(&quot;http://www.jarad.me/courses/stat401Eng/labs/lab06/creativity.csv&quot;)
</code></pre>

<pre><code>## Warning in file(file, &quot;rt&quot;): cannot open URL &#39;http://www.jarad.me/courses/
## stat401Eng/labs/lab06/creativity.csv&#39;: HTTP status was &#39;404 Not Found&#39;
</code></pre>

<pre><code>## Error in file(file, &quot;rt&quot;): cannot open the connection
</code></pre>

<pre><code class="r">intrinsic_score &lt;- creativity$Score[creativity$Treatment == &quot;Intrinsic&quot;]
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;creativity&#39; not found
</code></pre>

<pre><code class="r">extrinsic_score &lt;- creativity$Score[creativity$Treatment == &quot;Extrinsic&quot;]
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;creativity&#39; not found
</code></pre>

<pre><code class="r">t.test(intrinsic_score)
</code></pre>

<pre><code>## Error in t.test(intrinsic_score): object &#39;intrinsic_score&#39; not found
</code></pre>

<pre><code class="r">t.test(extrinsic_score)
</code></pre>

<pre><code>## Error in t.test(extrinsic_score): object &#39;extrinsic_score&#39; not found
</code></pre>

<pre><code class="r"># Using the `subset` command which subsets the data.frame
intrinsic &lt;- subset(creativity, Treatment == &quot;Intrinsic&quot;)
</code></pre>

<pre><code>## Error in subset(creativity, Treatment == &quot;Intrinsic&quot;): object &#39;creativity&#39; not found
</code></pre>

<pre><code class="r">extrinsic &lt;- subset(creativity, Treatment == &quot;Extrinsic&quot;)
</code></pre>

<pre><code>## Error in subset(creativity, Treatment == &quot;Extrinsic&quot;): object &#39;creativity&#39; not found
</code></pre>

<pre><code class="r">t.test(intrinsic$Score)
</code></pre>

<pre><code>## Error in t.test(intrinsic$Score): object &#39;intrinsic&#39; not found
</code></pre>

<pre><code class="r">t.test(extrinsic$Score)
</code></pre>

<pre><code>## Error in t.test(extrinsic$Score): object &#39;extrinsic&#39; not found
</code></pre>

<pre><code class="r"># Another way to subset uses the dplyr package
# This will be prettier when you have a long sequence of commands
library(dplyr)
</code></pre>

<pre><code>## 
## Attaching package: &#39;dplyr&#39;
</code></pre>

<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag
</code></pre>

<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union
</code></pre>

<pre><code class="r">intrinsic &lt;- creativity %&gt;% filter(Treatment == &quot;Intrinsic&quot;)
</code></pre>

<pre><code>## Error in eval(lhs, parent, parent): object &#39;creativity&#39; not found
</code></pre>

<pre><code class="r">extrinsic &lt;- creativity %&gt;% filter(Treatment == &quot;Extrinsic&quot;)
</code></pre>

<pre><code>## Error in eval(lhs, parent, parent): object &#39;creativity&#39; not found
</code></pre>

<p>If you want to find out more about these data, 
take a look at the help file for <code>case0101</code> in the 
<a href="https://cran.r-project.org/web/packages/Sleuth3/index.html">Sleuth3</a> package.</p>

<pre><code class="r">install.packages(&quot;Sleuth3&quot;)
library(&quot;Sleuth3&quot;)
?case0101
</code></pre>

<p></details></p>

</body>

</html>

