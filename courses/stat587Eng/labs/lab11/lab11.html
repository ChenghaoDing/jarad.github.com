<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Preparation</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h2>Preparation</h2>

<p>To follow along, use the <a href="lab11.R">lab11 code</a> and make sure the following 
packag is installed:</p>

<ul>
<li>emmeans</li>
</ul>

<p>You can use the following code to perform the installation:</p>

<pre><code class="r">install.packages(&quot;emmeans&quot;)
</code></pre>

<p>Now load the packages</p>

<pre><code class="r">library(&quot;tidyverse&quot;)
</code></pre>

<pre><code>## -- Attaching packages ------------------------------------------- tidyverse 1.3.0 --
</code></pre>

<pre><code>## v ggplot2 3.3.2     v purrr   0.3.4
## v tibble  3.0.3     v dplyr   1.0.1
## v tidyr   1.1.1     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0
</code></pre>

<pre><code>## -- Conflicts ---------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
</code></pre>

<pre><code class="r">library(&quot;emmeans&quot;)
</code></pre>

<h2>One explanatory variables</h2>

<p>Consider the <code>fiber</code> data set in the emmeans package where
the strength of fibers produced by 3 different machines is tested. </p>

<pre><code class="r">ggplot(emmeans::fiber, aes(machine, strength)) + 
  geom_jitter() + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/></p>

<h3>Means</h3>

<p>We might be interested in the mean strength of fibers produced by each machine.
One approach would be to fit a regression model and predict a new observation for each machine type.</p>

<pre><code class="r">m &lt;- lm(strength ~ machine, data = emmeans::fiber)
nd &lt;- data.frame(machine = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;))
p &lt;- predict(m, 
             newdata = nd, 
             interval = &quot;confidence&quot;)
bind_cols(nd, p %&gt;% as.data.frame)
</code></pre>

<pre><code>##   machine  fit      lwr      upr
## 1       A 41.4 37.36282 45.43718
## 2       B 43.2 39.16282 47.23718
## 3       C 36.0 31.96282 40.03718
</code></pre>

<p>Alternatively, use the <code>emmeans</code> function in the 
<a href="https://cran.r-project.org/web/packages/emmeans/index.html">emmeans</a> 
package.</p>

<pre><code class="r">emmeans(m, ~machine)
</code></pre>

<pre><code>##  machine emmean   SE df lower.CL upper.CL
##  A         41.4 1.85 12     37.4     45.4
##  B         43.2 1.85 12     39.2     47.2
##  C         36.0 1.85 12     32.0     40.0
## 
## Confidence level used: 0.95
</code></pre>

<h4>Means activity</h4>

<p>Consider the <code>ex0518</code> data set in the Sleuth3 package.</p>

<pre><code class="r">ex0518 &lt;- Sleuth3::ex0518 %&gt;%
  mutate(Treatment = relevel(Treatment, ref=&quot;Control&quot;))

ggplot(ex0518, aes(Treatment, Protein)) + 
  geom_jitter() + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/></p>

<p>Fit a regession model of protein on treatment and 
compute a point estimate as well as a 95% CI for the mean protein level in 
each of the treatment (diet) levels.</p>

<p><details><summary>Click for solution</summary> </p>

<pre><code class="r">m &lt;- lm(Protein ~ Treatment, data = ex0518)
emmeans(m, ~Treatment)
</code></pre>

<pre><code>##  Treatment emmean   SE df lower.CL upper.CL
##  Control      186 4.44 24      176      195
##  CPFA150      172 9.93 24      151      192
##  CPFA300      147 9.93 24      126      167
##  CPFA450      151 9.93 24      131      171
##  CPFA50       168 9.93 24      148      189
##  CPFA600      152 9.93 24      132      173
## 
## Confidence level used: 0.95
</code></pre>

<p></details></p>

<h3>Comparison of means</h3>

<p>Typically we are more interested in saying something about differences in means.
We can either try to specify the contrasts of interest, or we can use 
pre-packaged analyses to extract those contrasts we are interested in.
Suppose that machine C was really the control and we are interested primarily
in comparing </p>

<ul>
<li>machine A to machine C and</li>
<li>machine B to machine C.</li>
</ul>

<p>We can use the <code>contrast</code>  function in the <code>emmeans</code> package to perform the
comparison.</p>

<pre><code class="r"># First let&#39;s make C the reference level
fiber &lt;- emmeans::fiber %&gt;% 
  mutate(machine = relevel(machine, ref=&quot;C&quot;))

m &lt;- lm(strength ~ machine, data = fiber)
ls &lt;- emmeans(m, ~ machine)
(co &lt;- contrast(ls, method = &quot;pairwise&quot;))
</code></pre>

<pre><code>##  contrast estimate   SE df t.ratio p.value
##  C - A        -5.4 2.62 12 -2.061  0.1402 
##  C - B        -7.2 2.62 12 -2.748  0.0434 
##  A - B        -1.8 2.62 12 -0.687  0.7754 
## 
## P value adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<p>To get the CIs, use <code>confint</code>:</p>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast estimate   SE df lower.CL upper.CL
##  C - A        -5.4 2.62 12   -12.39    1.591
##  C - B        -7.2 2.62 12   -14.19   -0.209
##  A - B        -1.8 2.62 12    -8.79    5.191
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<p>By default, these functions use a Tukey multiple comparison adjustment which is the most appropriate adjustment for performing all pairwise comparisons. </p>

<p>You can turn off the adjustment by setting the <code>adjust</code> argument to &ldquo;none&rdquo;, e.g.</p>

<pre><code class="r">(co &lt;- contrast(ls, method = &quot;pairwise&quot;, adjust=&quot;none&quot;))
</code></pre>

<pre><code>##  contrast estimate   SE df t.ratio p.value
##  C - A        -5.4 2.62 12 -2.061  0.0617 
##  C - B        -7.2 2.62 12 -2.748  0.0177 
##  A - B        -1.8 2.62 12 -0.687  0.5052
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast estimate   SE df lower.CL upper.CL
##  C - A        -5.4 2.62 12   -11.11    0.309
##  C - B        -7.2 2.62 12   -12.91   -1.491
##  A - B        -1.8 2.62 12    -7.51    3.909
## 
## Confidence level used: 0.95
</code></pre>

<p>Also, we weren&#39;t really interested in looking at all pairwise comparisons.
Instead, we were really mainly interested in looking at machine A/B versus 
machine C (the control).</p>

<p>We can specify just these comparisons by changing the <code>method</code> argument to 
&ldquo;trt.vs.ctrl&rdquo; (which stands for treatment vs control).</p>

<pre><code class="r">(co &lt;- contrast(ls, method = &quot;trt.vs.ctrl&quot;))
</code></pre>

<pre><code>##  contrast estimate   SE df t.ratio p.value
##  A - C         5.4 2.62 12 2.061   0.1123 
##  B - C         7.2 2.62 12 2.748   0.0333 
## 
## P value adjustment: dunnettx method for 2 tests
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast estimate   SE df lower.CL upper.CL
##  A - C         5.4 2.62 12    -1.21     12.0
##  B - C         7.2 2.62 12     0.59     13.8
## 
## Confidence level used: 0.95 
## Conf-level adjustment: dunnettx method for 2 estimates
</code></pre>

<p>Notice that the adjustment method used here is the <code>dunnettx</code> method which is
an approximation to the exact Dunnett method.
The exact Dunnett method is an appropriate choice when comparing treatments to a 
control and can be obtained using <code>adjust = &quot;mvt&quot;</code>, but this requires more computing time.</p>

<h4>Contrast activity</h4>

<p>Reconsider the <code>ex0518</code> data set and provide an estimate and 95% CI for the 
difference in mean protein level for all treatments compared to control.</p>

<p><details><summary>Click for solution</summary>  </p>

<pre><code class="r">m &lt;- lm(Protein ~ Treatment, data = ex0518)
ls &lt;- emmeans(m, ~ Treatment)
(co &lt;- contrast(ls, method = &quot;trt.vs.ctrl&quot;))
</code></pre>

<pre><code>##  contrast          estimate   SE df t.ratio p.value
##  CPFA150 - Control    -13.9 10.9 24 -1.281  0.5708 
##  CPFA300 - Control    -38.9 10.9 24 -3.579  0.0068 
##  CPFA450 - Control    -34.6 10.9 24 -3.181  0.0174 
##  CPFA50 - Control     -17.3 10.9 24 -1.587  0.3907 
##  CPFA600 - Control    -33.3 10.9 24 -3.058  0.0232 
## 
## P value adjustment: dunnettx method for 5 tests
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast          estimate   SE df lower.CL upper.CL
##  CPFA150 - Control    -13.9 10.9 24    -43.4    15.58
##  CPFA300 - Control    -38.9 10.9 24    -68.4    -9.42
##  CPFA450 - Control    -34.6 10.9 24    -64.1    -5.09
##  CPFA50 - Control     -17.3 10.9 24    -46.8    12.25
##  CPFA600 - Control    -33.3 10.9 24    -62.8    -3.75
## 
## Confidence level used: 0.95 
## Conf-level adjustment: dunnettx method for 5 estimates
</code></pre>

<p></details></p>

<h2>Two categorical explanatory variables</h2>

<p>These data are taken from 
<a href="https://woodgears.ca/joint_strength/glue.html">a wood glue experiment</a>.
For simplicity, the data here are taken to be balanced.</p>

<pre><code class="r">wood_glue &lt;- data.frame(weight = c(185,170,210,240,245,190,210,250,
                                  290,280,260,270,200,280,350,350),
                        wood = rep(c(&quot;spruce&quot;,&quot;maple&quot;), each = 8),
                        glue = rep(c(&quot;carpenter&#39;s&quot;,&quot;weldbond&quot;,
                                     &quot;gorilla&quot;,&quot;titebond&quot;), 
                                   each=2, times=2))
</code></pre>

<pre><code class="r">ggplot(wood_glue, aes(wood, weight, color=glue, shape=glue)) +
  geom_jitter() +
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/></p>

<p>We can fit the regression model with wood, glue, and their interaction.</p>

<pre><code class="r">m &lt;- lm(weight ~ wood*glue, data = wood_glue)
anova(m)
</code></pre>

<pre><code>## Analysis of Variance Table
## 
## Response: weight
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## wood       1 21025.0 21025.0 27.2389 0.0008035 ***
## glue       3  9687.5  3229.2  4.1835 0.0468482 *  
## wood:glue  3  7037.5  2345.8  3.0391 0.0927400 .  
## Residuals  8  6175.0   771.9                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<h3>Compare mean weight averaged across wood type</h3>

<pre><code class="r">(ls &lt;- emmeans(m, ~ glue))
</code></pre>

<pre><code>## NOTE: Results may be misleading due to involvement in interactions
</code></pre>

<pre><code>##  glue        emmean   SE df lower.CL upper.CL
##  carpenter&#39;s    231 13.9  8      199      263
##  gorilla        229 13.9  8      197      261
##  titebond       290 13.9  8      258      322
##  weldbond       245 13.9  8      213      277
## 
## Results are averaged over the levels of: wood 
## Confidence level used: 0.95
</code></pre>

<p>The note here indicates that there may be issues with comparing glues when
averaged over wood since, by construction of the model, the glue&#39;s effect on 
the weight may be different depending on the wood type.</p>

<p>If we want to compare the glues, we can use <code>contrast</code> as before.</p>

<pre><code class="r">(co &lt;- contrast(ls, &quot;pairwise&quot;))
</code></pre>

<pre><code>##  contrast               estimate   SE df t.ratio p.value
##  carpenter&#39;s - gorilla       2.5 19.6  8  0.127  0.9992 
##  carpenter&#39;s - titebond    -58.8 19.6  8 -2.991  0.0674 
##  carpenter&#39;s - weldbond    -13.8 19.6  8 -0.700  0.8943 
##  gorilla - titebond        -61.2 19.6  8 -3.118  0.0563 
##  gorilla - weldbond        -16.2 19.6  8 -0.827  0.8403 
##  titebond - weldbond        45.0 19.6  8  2.291  0.1794 
## 
## Results are averaged over the levels of: wood 
## P value adjustment: tukey method for comparing a family of 4 estimates
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast               estimate   SE df lower.CL upper.CL
##  carpenter&#39;s - gorilla       2.5 19.6  8    -60.4    65.41
##  carpenter&#39;s - titebond    -58.8 19.6  8   -121.7     4.16
##  carpenter&#39;s - weldbond    -13.8 19.6  8    -76.7    49.16
##  gorilla - titebond        -61.2 19.6  8   -124.2     1.66
##  gorilla - weldbond        -16.2 19.6  8    -79.2    46.66
##  titebond - weldbond        45.0 19.6  8    -17.9   107.91
## 
## Results are averaged over the levels of: wood 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 4 estimates
</code></pre>

<h3>Compare mean weight within each wood type</h3>

<p>Since the glue&#39;s effect may depend on wood type, 
we may be interested in comparing the glues within each wood type.
To estimate the mean weight required to break the joint for every wood-glue 
combination use the <code>emmeans</code> function with <code>A|B</code> denoting we want to calculate
the means for A by B. </p>

<pre><code class="r">(em &lt;- emmeans(m, ~ glue | wood))
</code></pre>

<pre><code>## wood = maple:
##  glue        emmean   SE df lower.CL upper.CL
##  carpenter&#39;s    285 19.6  8      240      330
##  gorilla        240 19.6  8      195      285
##  titebond       350 19.6  8      305      395
##  weldbond       265 19.6  8      220      310
## 
## wood = spruce:
##  glue        emmean   SE df lower.CL upper.CL
##  carpenter&#39;s    178 19.6  8      132      223
##  gorilla        218 19.6  8      172      263
##  titebond       230 19.6  8      185      275
##  weldbond       225 19.6  8      180      270
## 
## Confidence level used: 0.95
</code></pre>

<p>We would have gotten the exact same result if we switched <code>glue</code> and <code>wood</code>, 
but this provides a table in the more directly comparable order.</p>

<p>If we want to compare glues within the wood type, we again use <code>contrast</code>. </p>

<pre><code class="r">(co &lt;- contrast(em, &quot;pairwise&quot;))
</code></pre>

<pre><code>## wood = maple:
##  contrast               estimate   SE df t.ratio p.value
##  carpenter&#39;s - gorilla      45.0 27.8  8  1.620  0.4204 
##  carpenter&#39;s - titebond    -65.0 27.8  8 -2.340  0.1678 
##  carpenter&#39;s - weldbond     20.0 27.8  8  0.720  0.8865 
##  gorilla - titebond       -110.0 27.8  8 -3.959  0.0176 
##  gorilla - weldbond        -25.0 27.8  8 -0.900  0.8055 
##  titebond - weldbond        85.0 27.8  8  3.059  0.0612 
## 
## wood = spruce:
##  contrast               estimate   SE df t.ratio p.value
##  carpenter&#39;s - gorilla     -40.0 27.8  8 -1.440  0.5116 
##  carpenter&#39;s - titebond    -52.5 27.8  8 -1.890  0.3039 
##  carpenter&#39;s - weldbond    -47.5 27.8  8 -1.710  0.3787 
##  gorilla - titebond        -12.5 27.8  8 -0.450  0.9678 
##  gorilla - weldbond         -7.5 27.8  8 -0.270  0.9926 
##  titebond - weldbond         5.0 27.8  8  0.180  0.9978 
## 
## P value adjustment: tukey method for comparing a family of 4 estimates
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>## wood = maple:
##  contrast               estimate   SE df lower.CL upper.CL
##  carpenter&#39;s - gorilla      45.0 27.8  8   -43.97    134.0
##  carpenter&#39;s - titebond    -65.0 27.8  8  -153.97     24.0
##  carpenter&#39;s - weldbond     20.0 27.8  8   -68.97    109.0
##  gorilla - titebond       -110.0 27.8  8  -198.97    -21.0
##  gorilla - weldbond        -25.0 27.8  8  -113.97     64.0
##  titebond - weldbond        85.0 27.8  8    -3.97    174.0
## 
## wood = spruce:
##  contrast               estimate   SE df lower.CL upper.CL
##  carpenter&#39;s - gorilla     -40.0 27.8  8  -128.97     49.0
##  carpenter&#39;s - titebond    -52.5 27.8  8  -141.47     36.5
##  carpenter&#39;s - weldbond    -47.5 27.8  8  -136.47     41.5
##  gorilla - titebond        -12.5 27.8  8  -101.47     76.5
##  gorilla - weldbond         -7.5 27.8  8   -96.47     81.5
##  titebond - weldbond         5.0 27.8  8   -83.97     94.0
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 4 estimates
</code></pre>

<h4>Two categorical explanatory variables activity</h4>

<p>Consider the <code>ex1321</code> data set in the Sleuth3 package. 
Estimate the average treatment effect on the intelligence test across all the 
classes.</p>

<p><details><summary>Click for solution</summary> </p>

<p>We should always look at the data first.</p>

<pre><code class="r">ggplot(Sleuth3::ex1321, aes(Class, Gain, color=Treatment, shape = Treatment)) +
  geom_jitter() + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-20"/></p>

<p>Then we can estimate the average treatment effect across the classes.</p>

<pre><code class="r">m &lt;- lm(Gain ~ Treatment*Class, data = Sleuth3::ex1321)
(em &lt;- emmeans(m, ~ Treatment))
</code></pre>

<pre><code>## NOTE: Results may be misleading due to involvement in interactions
</code></pre>

<pre><code>##  Treatment emmean    SE  df lower.CL upper.CL
##  control     8.52 0.773 286      7.0     10.0
##  pygmalion  13.67 1.749 286     10.2     17.1
## 
## Results are averaged over the levels of: Class 
## Confidence level used: 0.95
</code></pre>

<pre><code class="r">(co &lt;- contrast(em, &quot;pairwise&quot;))
</code></pre>

<pre><code>##  contrast            estimate   SE  df t.ratio p.value
##  control - pygmalion    -5.15 1.91 286 -2.693  0.0075 
## 
## Results are averaged over the levels of: Class
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast            estimate   SE  df lower.CL upper.CL
##  control - pygmalion    -5.15 1.91 286    -8.92    -1.39
## 
## Results are averaged over the levels of: Class 
## Confidence level used: 0.95
</code></pre>

<p></details></p>

<h2>ANCOVA - Categorical explanatory variable with continuous explanatory variable</h2>

<p>Reconsider the <code>fiber</code> data set in the emmeans package where
the strength of fibers produced by 3 different machines is tested. 
The machines do not actually produce a uniform size fiber.
So in addition to recording the strength, the diameter of the fiber is also 
recorded.
Since we expect there to be differences in strength depending on the diameter,
we should compare machine after adjusting for diameter. </p>

<pre><code class="r">ggplot(emmeans::fiber, aes(diameter, strength, color=machine, shape=machine)) + 
  geom_jitter() + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"/></p>

<h3>Comparing treatments at a particular level of the continuous explanatory variable</h3>

<p>We will fit the model with an interaction between machine and diameter to allow
the possibility that the effect of diameter depends on the machine.</p>

<pre><code class="r">m &lt;- lm(strength ~ diameter*machine, data=fiber)
em &lt;- emmeans(m, ~ machine)
</code></pre>

<pre><code>## NOTE: Results may be misleading due to involvement in interactions
</code></pre>

<pre><code class="r">co &lt;- contrast(em, method = &quot;pairwise&quot;)
confint(co)
</code></pre>

<pre><code>##  contrast estimate   SE df lower.CL upper.CL
##  C - A       -1.69 1.24  9    -5.15    1.775
##  C - B       -3.07 1.29  9    -6.67    0.542
##  A - B       -1.38 1.16  9    -4.61    1.853
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<p>Again, 
we are warned that these results may not make sense due to the interaction.
Perhaps we should evaluate these at a particular diameter.</p>

<pre><code class="r">em &lt;- emmeans(m, ~ machine | diameter)
co &lt;- contrast(em, method = &quot;pairwise&quot;)
confint(co)
</code></pre>

<pre><code>## diameter = 24.1:
##  contrast estimate   SE df lower.CL upper.CL
##  C - A       -1.69 1.24  9    -5.15    1.775
##  C - B       -3.07 1.29  9    -6.67    0.542
##  A - B       -1.38 1.16  9    -4.61    1.853
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<p>We can see that, in fact, the analysis provided above was at a diameter of 
24.1333 which happens to be the mean diameter in the data set.</p>

<pre><code class="r">mean(fiber$diameter)
</code></pre>

<pre><code>## [1] 24.13333
</code></pre>

<p>To set your own value(s) for diameter use the <code>at</code> argument, e.g.</p>

<pre><code class="r">em &lt;- emmeans(m, ~ machine | diameter, at = list(diameter = c(20,30)))
co &lt;- contrast(em, method = &quot;pairwise&quot;)
confint(co)
</code></pre>

<pre><code>## diameter = 20:
##  contrast estimate   SE df lower.CL upper.CL
##  C - A      -0.695 1.48  9    -4.83     3.45
##  C - B      -3.094 1.73  9    -7.92     1.73
##  A - B      -2.399 1.98  9    -7.94     3.14
## 
## diameter = 30:
##  contrast estimate   SE df lower.CL upper.CL
##  C - A      -3.096 2.31  9    -9.55     3.36
##  C - B      -3.024 2.30  9    -9.44     3.39
##  A - B       0.072 1.67  9    -4.59     4.73
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<h3>Comparing the effect of the continuous variable across machines</h3>

<p>We can also look at the effect of the continuous variable across machines and 
see if this is the same, i.e. is the slope the same for all machines.
To do this we use the <code>lstrends</code> function.</p>

<pre><code class="r">( lst &lt;- lstrends(m, &quot;machine&quot;, var = &quot;diameter&quot;) )
</code></pre>

<pre><code>##  machine diameter.trend    SE df lower.CL upper.CL
##  C                0.864 0.208  9    0.394     1.33
##  A                1.104 0.194  9    0.666     1.54
##  B                0.857 0.224  9    0.351     1.36
## 
## Confidence level used: 0.95
</code></pre>

<pre><code class="r">(co &lt;- contrast(lst, method = &quot;pairwise&quot;))
</code></pre>

<pre><code>##  contrast estimate    SE df t.ratio p.value
##  C - A    -0.24008 0.284  9 -0.845  0.6863 
##  C - B     0.00705 0.306  9  0.023  0.9997 
##  A - B     0.24714 0.296  9  0.835  0.6919 
## 
## P value adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast estimate    SE df lower.CL upper.CL
##  C - A    -0.24008 0.284  9   -1.034    0.554
##  C - B     0.00705 0.306  9   -0.846    0.860
##  A - B     0.24714 0.296  9   -0.579    1.074
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<h4>ANCOVA activity</h4>

<p>Take a look at the bat energy expenditure data set in <code>case1002</code> and determine
the relationship between echo-locating ability and energy expenditure after
adjusting for mass. 
In particular, compare the differences in mean energy expenditure between 
echolocating bats and non-echolocating bats as well as echolocating bats and 
birds at the mean mass.
Does comparing at the mean mass make sense?
Also compare the effects of mass on mean energy expenditure between those same 
groups.</p>

<p><details><summary>Click for solution</summary> </p>

<p>As always, plot the data. </p>

<pre><code class="r">ggplot(Sleuth3::case1002, aes(Mass, Energy, color = Type, shape = Type)) +
  geom_jitter() + 
  theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-28"/></p>

<p>Compare energy expenditure at mean mass.</p>

<pre><code class="r">m &lt;- lm(Energy ~ Mass*Type, data = Sleuth3::case1002)
ls &lt;- emmeans(m, ~ Type | Mass)
co &lt;- contrast(ls, &quot;trt.vs.ctrl&quot;) 
confint(co)
</code></pre>

<pre><code>## Mass = 263:
##  contrast                                     estimate   SE df lower.CL
##  (non-echolocating bats) - echolocating bats     -2.29 16.5 14    -43.2
##  (non-echolocating birds) - echolocating bats    -2.92 16.2 14    -43.0
##  upper.CL
##      38.6
##      37.1
## 
## Confidence level used: 0.95 
## Conf-level adjustment: dunnettx method for 2 estimates
</code></pre>

<p>This doesn&#39;t really make sense since there are no echolocating bats whose mass 
is anywhere near this range.</p>

<p>To compare the slopes, use </p>

<pre><code class="r">( lst &lt;- lstrends(m, &quot;Type&quot;, var = &quot;Mass&quot;) )
</code></pre>

<pre><code>##  Type                   Mass.trend     SE df lower.CL upper.CL
##  echolocating bats          0.0896 0.0680 14  -0.0563   0.2356
##  non-echolocating bats      0.0400 0.0117 14   0.0150   0.0651
##  non-echolocating birds     0.0678 0.0092 14   0.0480   0.0875
## 
## Confidence level used: 0.95
</code></pre>

<pre><code class="r">(co &lt;- contrast(lst, method = &quot;pairwise&quot;))
</code></pre>

<pre><code>##  contrast                                           estimate     SE df t.ratio
##  echolocating bats - (non-echolocating bats)          0.0496 0.0690 14  0.718 
##  echolocating bats - (non-echolocating birds)         0.0219 0.0687 14  0.318 
##  (non-echolocating bats) - (non-echolocating birds)  -0.0277 0.0149 14 -1.867 
##  p.value
##  0.7569 
##  0.9459 
##  0.1848 
## 
## P value adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<pre><code class="r">confint(co)
</code></pre>

<pre><code>##  contrast                                           estimate     SE df lower.CL
##  echolocating bats - (non-echolocating bats)          0.0496 0.0690 14  -0.1311
##  echolocating bats - (non-echolocating birds)         0.0219 0.0687 14  -0.1579
##  (non-echolocating bats) - (non-echolocating birds)  -0.0277 0.0149 14  -0.0666
##  upper.CL
##    0.2303
##    0.2016
##    0.0111
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates
</code></pre>

<p></details></p>

<h2>Custom contrasts</h2>

<p>Although pairwise comparisons are common for contrasts, 
we may be interested in more sophisticated contrasts. 
For example, in the mice lifetime diet, we may be interested in comparing 
the standard N/N85 diet to the low calorie diets.
In addition, we may be interested in comparing N/R50 vs R/R50 to look specifically
at pre-weaning calorie restriction.
To perform these analysis, we use custom contrasts (although the second one is 
technically part of the pairwise comarisons).</p>

<pre><code class="r">m &lt;- lm(Lifetime ~ Diet, data = Sleuth3::case0501)
ls &lt;- emmeans(m, &quot;Diet&quot;)
#                                           N/N85 N/R40 N/R50  NP R/R50 lopro
co &lt;- contrast(ls, list(`High - Low`    = c(    4,   -1,   -1,  0,   -1,   -1) /4,
                        `Pre-wean: R-N` = c(    0,    0,   -1,  0,    1,    0) ))
confint(co)
</code></pre>

<pre><code>##  contrast      estimate    SE  df lower.CL upper.CL
##  High - Low      -9.805 0.984 343   -11.74    -7.87
##  Pre-wean: R-N    0.589 1.194 343    -1.76     2.94
## 
## Confidence level used: 0.95
</code></pre>

</body>

</html>

