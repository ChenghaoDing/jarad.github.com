--- 
type: post
status: publish
published: true
title: Convergence to a distribution
meta: 
  aktt_tweeted: "1"
  _edit_last: "2"
  aktt_notify_twitter: "yes"
  _aktt_hash_meta: "#tt"
tags: 
- Bayesian
- convergence
- MCMC
- multimodal
- random-walk Metropolis
layout: post
---
A non-stats colleague asked me yesterday about what happens to an MCMC chain when the posterior is multimodal. I believe their mindset is that convergence happens to a point since this is the way the many algorithms work, e.g. <a title="optimization" href="http://www.amazon.com/Practical-Methods-Optimization-R-Fletcher/dp/0471494631/ref=sr_1_2?ie=UTF8&amp;qid=1323971801&amp;sr=8-2" target="_blank">hill-climbing algorithms</a>. MCMC chains, as typically used in Bayesian analysis, don't converge to a point rather they <strong>converge to a distribution</strong>. So an MCMC chain will explore the entire posterior which includes all modes of that posterior.

Take a simple example where the posterior is a equal-weighted mixture of two normal distributions both with variance 1. The means of these distributions are positive and negative some known constant, in the example below I used 3. If the constant is sufficiently large, then the distribution is multimodal and an MCMC algorithm will alternate (although not every iteration) between the two modes as it samples. Below I implemented a random-walk Metropolis algorithm that samples from this distribution. From the partial traceplot it is clear that this algorithm gets stuck in both modes for a few iterations before making its way to the other mode.

Of course problems can get much more complicated and more sophisticated algorithms, e.g. <a title="Simulated annealing " href="http://en.wikipedia.org/wiki/Simulated_annealing" target="_blank">simulated annealing</a> and <a title="Parallel tempering" href="http://en.wikipedia.org/wiki/Parallel_tempering" target="_blank">parallel tempering</a> (see chapter 10 of <a title="Handbook of Markov Chain Monte Carlo" href="http://www.amazon.com/Handbook-Chapman-Handbooks-Statistical-Methods/dp/1420079417/ref=sr_1_sc_2?s=books&amp;ie=UTF8&amp;qid=1323972259&amp;sr=1-2-spell" target="_blank">this book</a> for recent developments), are necessary for exploring these posteriors.

<a href="http://jaradniemi.com/2011/12/15/convergence-to-a-distribution/convergencetodistribution/" rel="attachment wp-att-1182"><img class="aligncenter size-full wp-image-1182" title="convergenceToDistribution" src="http://jaradniemi.com/blog/wp-content/uploads/convergenceToDistribution.png" alt="" width="480" height="480" /></a>

<script src="https://gist.github.com/1482981.js"> </script>

Edit: Trying out <a href="https://gist.github.com/" title="Gist" target="_blank">gist.github.com</a>. How can I decease the font size?
